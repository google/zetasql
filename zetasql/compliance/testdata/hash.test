[name=hash_functions_1]
SELECT
  input_string,
  MD5(input_bytes),
  MD5(input_string),
  SHA1(input_bytes),
  SHA1(input_string),
  SHA256(input_bytes),
  SHA256(input_string),
  SHA512(input_bytes),
  SHA512(input_string)
FROM (
  SELECT
    CAST(input_string AS BYTES) AS input_bytes,
    input_string,
    off
  FROM UNNEST(['', 'a b c d', 'abcABCжщфЖЩФ', 'a b c d',
               'Моша_öá5ホバークラフト鰻鰻']) AS input_string WITH OFFSET off
)
ORDER BY off
--
ARRAY<STRUCT<input_string STRING,
             BYTES,
             BYTES,
             BYTES,
             BYTES,
             BYTES,
             BYTES,
             BYTES,
             BYTES>>
[
  {
    "",
    b"\xd4\x1d\x8c\xd9\x8f\x00\xb2\x04\xe9\x80\x09\x98\xec\xf8B~",
    b"\xd4\x1d\x8c\xd9\x8f\x00\xb2\x04\xe9\x80\x09\x98\xec\xf8B~",
    b"\xda9\xa3\xee^kK\x0d2U\xbf\xef\x95`\x18\x90\xaf\xd8\x07\x09",
    b"\xda9\xa3\xee^kK\x0d2U\xbf\xef\x95`\x18\x90\xaf\xd8\x07\x09",
    b"\xe3\xb0\xc4B\x98\xfc\x1c\x14\x9a\xfb\xf4\xc8\x99o\xb9$'\xaeA\xe4d\x9b\x93L\xa4\x95\x99\x1bxR\xb8U",
    b"\xe3\xb0\xc4B\x98\xfc\x1c\x14\x9a\xfb\xf4\xc8\x99o\xb9$'\xaeA\xe4d\x9b\x93L\xa4\x95\x99\x1bxR\xb8U",
    b"\xcf\x83\xe15~\xef\xb8\xbd\xf1T(P\xd6m\x80\x07\xd6 \xe4\x05\x0bW\x15\xdc\x83\xf4\xa9!\xd3l\xe9\xceG\xd0\xd1<]\x85\xf2\xb0\xff\x83\x18\xd2\x87~\xec/c\xb91\xbdGAz\x81\xa582z\xf9'\xda>",
    b"\xcf\x83\xe15~\xef\xb8\xbd\xf1T(P\xd6m\x80\x07\xd6 \xe4\x05\x0bW\x15\xdc\x83\xf4\xa9!\xd3l\xe9\xceG\xd0\xd1<]\x85\xf2\xb0\xff\x83\x18\xd2\x87~\xec/c\xb91\xbdGAz\x81\xa582z\xf9'\xda>"
  },
  {
    "a b c d",
    b"q?Y+\xd57\xf7r]I\x1a\x03\xe87\xd6J",
    b"q?Y+\xd57\xf7r]I\x1a\x03\xe87\xd6J",
    b"0\xa4}\x96n\x96\xef\x82\x053\xb1`\xcd%\xbca\xceq\xec|",
    b"0\xa4}\x96n\x96\xef\x82\x053\xb1`\xcd%\xbca\xceq\xec|",
    b"\xf8,\xe1\xb6S\xe3\x0b\x1c\xebW\x11\xbb\xf7Ye\xdd$Q0\x11\xd7\xda\xa4\x8b\xbd\x86\x10U\x01T\xa1\xfd",
    b"\xf8,\xe1\xb6S\xe3\x0b\x1c\xebW\x11\xbb\xf7Ye\xdd$Q0\x11\xd7\xda\xa4\x8b\xbd\x86\x10U\x01T\xa1\xfd",
    b"\xa9a\xae&\xa9\xf6\xd3&\xee\x11\xf8\xe8D\xba\xb7\x90\xc1\x1f\xc8\xdci\x8d\xd6\\\x8f\xa2\x82\xa3\xee\x8a\xaf\xc3q\x85\xc6\xa1\xabW\x9a\xb2dz\xb9D\xfc\xa7\xfb\xbc\xdd\x8dTo\x81 \xf0\x13)\xd6\xd0\x1cR\xc3[\x81",
    b"\xa9a\xae&\xa9\xf6\xd3&\xee\x11\xf8\xe8D\xba\xb7\x90\xc1\x1f\xc8\xdci\x8d\xd6\\\x8f\xa2\x82\xa3\xee\x8a\xaf\xc3q\x85\xc6\xa1\xabW\x9a\xb2dz\xb9D\xfc\xa7\xfb\xbc\xdd\x8dTo\x81 \xf0\x13)\xd6\xd0\x1cR\xc3[\x81"
  },
  {
    "abcABCжщфЖЩФ",
    b"\xcb\xd1M\x08\x9fx\xb5\xc0\x1f^H\x8d\x93L\x1e\xdc",
    b"\xcb\xd1M\x08\x9fx\xb5\xc0\x1f^H\x8d\x93L\x1e\xdc",
    b'0<<^\xf4\x82$\xe1V\xc9\xe0\x89\x9b\x01\xd8"_\xf7\x0f ',
    b'0<<^\xf4\x82$\xe1V\xc9\xe0\x89\x9b\x01\xd8"_\xf7\x0f ',
    b"\xb0\xc4\x86\xd0CN\x07\x8f\xa1\xff\x8f\xc2;\xf9\x84\xbcA\xdd1\xd2\xe9\\\xa6\x9aB}\xdb\xbbV\xb2\x9f\xc2",
    b"\xb0\xc4\x86\xd0CN\x07\x8f\xa1\xff\x8f\xc2;\xf9\x84\xbcA\xdd1\xd2\xe9\\\xa6\x9aB}\xdb\xbbV\xb2\x9f\xc2",
    b"f\x8c\xa2\x97\xacW\xfaT\x05\xafw\xea\xc9\xcf\xcaa\xdf(*\x7f\xa9\xc6\x19H@\x8c\xd3!\x81PA\x1d\x98\x12\x9f\xf7\x9eD9\xe46[\x80Rs\xfb\x87\xf7d\x16zP\x19>U\x0dY\x9e\x97A\xc5D.\xcd",
    b"f\x8c\xa2\x97\xacW\xfaT\x05\xafw\xea\xc9\xcf\xcaa\xdf(*\x7f\xa9\xc6\x19H@\x8c\xd3!\x81PA\x1d\x98\x12\x9f\xf7\x9eD9\xe46[\x80Rs\xfb\x87\xf7d\x16zP\x19>U\x0dY\x9e\x97A\xc5D.\xcd"
  },
  {
    "a b c d",
    b"q?Y+\xd57\xf7r]I\x1a\x03\xe87\xd6J",
    b"q?Y+\xd57\xf7r]I\x1a\x03\xe87\xd6J",
    b"0\xa4}\x96n\x96\xef\x82\x053\xb1`\xcd%\xbca\xceq\xec|",
    b"0\xa4}\x96n\x96\xef\x82\x053\xb1`\xcd%\xbca\xceq\xec|",
    b"\xf8,\xe1\xb6S\xe3\x0b\x1c\xebW\x11\xbb\xf7Ye\xdd$Q0\x11\xd7\xda\xa4\x8b\xbd\x86\x10U\x01T\xa1\xfd",
    b"\xf8,\xe1\xb6S\xe3\x0b\x1c\xebW\x11\xbb\xf7Ye\xdd$Q0\x11\xd7\xda\xa4\x8b\xbd\x86\x10U\x01T\xa1\xfd",
    b"\xa9a\xae&\xa9\xf6\xd3&\xee\x11\xf8\xe8D\xba\xb7\x90\xc1\x1f\xc8\xdci\x8d\xd6\\\x8f\xa2\x82\xa3\xee\x8a\xaf\xc3q\x85\xc6\xa1\xabW\x9a\xb2dz\xb9D\xfc\xa7\xfb\xbc\xdd\x8dTo\x81 \xf0\x13)\xd6\xd0\x1cR\xc3[\x81",
    b"\xa9a\xae&\xa9\xf6\xd3&\xee\x11\xf8\xe8D\xba\xb7\x90\xc1\x1f\xc8\xdci\x8d\xd6\\\x8f\xa2\x82\xa3\xee\x8a\xaf\xc3q\x85\xc6\xa1\xabW\x9a\xb2dz\xb9D\xfc\xa7\xfb\xbc\xdd\x8dTo\x81 \xf0\x13)\xd6\xd0\x1cR\xc3[\x81"
  },
  {
    "Моша_öá5ホバークラフト鰻鰻",
    b"O\x84\xa3\x8du\x07\x8c\x15\x81\x8c\xac\xa6\xb8k&\xbe",
    b"O\x84\xa3\x8du\x07\x8c\x15\x81\x8c\xac\xa6\xb8k&\xbe",
    b"n\xd4\x8c'_\xe4\xd8\xd7\xbd\x9d\xaa7\xfa\xb7+\xd2l\x09\xc9\xc4",
    b"n\xd4\x8c'_\xe4\xd8\xd7\xbd\x9d\xaa7\xfa\xb7+\xd2l\x09\xc9\xc4",
    b"0\xcbl.\x95\xbd\x9d\xaf\xa5\xad\xb1\xf5S\xed\xb7\x83\x11$\xd9q-&1\xcd\xb9\xf7\xf3\x87\xc6\xcc'A",
    b"0\xcbl.\x95\xbd\x9d\xaf\xa5\xad\xb1\xf5S\xed\xb7\x83\x11$\xd9q-&1\xcd\xb9\xf7\xf3\x87\xc6\xcc'A",
    b'\xe5;\x83\xe0\xaecy\xa9\x87\xee6\\;p\xff"G<\xf1\x91\x9d!1(\xeb\xf3k\x99}{\x8f\x13c\xca\xe8\xed\xd9\x12\xcd\x14\xadI\x9c\x10_\x97L\xb1\xf8\xc8\xa5\xdb\x9d\xdb\xd7jO\x11%\xdeH\x04@\xa8',
    b'\xe5;\x83\xe0\xaecy\xa9\x87\xee6\\;p\xff"G<\xf1\x91\x9d!1(\xeb\xf3k\x99}{\x8f\x13c\xca\xe8\xed\xd9\x12\xcd\x14\xadI\x9c\x10_\x97L\xb1\xf8\xc8\xa5\xdb\x9d\xdb\xd7jO\x11%\xdeH\x04@\xa8'
  }
]
==

[name=hash_functions_2]
SELECT
  input_bytes,
  MD5(input_bytes),
  SHA1(input_bytes),
  SHA256(input_bytes),
  SHA512(input_bytes)
FROM UNNEST([b'', b'a b c d', b'', b'a b c d', b'\x00\x01\x02\x03\x04\x05',
             b'Моша_öá5ホバークラフト鰻鰻',
             b'\xAF\xBF\xCF\xDF\xEF\xFF']) AS input_bytes WITH OFFSET off
ORDER BY off
--
ARRAY<STRUCT<input_bytes BYTES, BYTES, BYTES, BYTES, BYTES>>[
  {
    b"",
    b"\xd4\x1d\x8c\xd9\x8f\x00\xb2\x04\xe9\x80\x09\x98\xec\xf8B~",
    b"\xda9\xa3\xee^kK\x0d2U\xbf\xef\x95`\x18\x90\xaf\xd8\x07\x09",
    b"\xe3\xb0\xc4B\x98\xfc\x1c\x14\x9a\xfb\xf4\xc8\x99o\xb9$'\xaeA\xe4d\x9b\x93L\xa4\x95\x99\x1bxR\xb8U",
    b"\xcf\x83\xe15~\xef\xb8\xbd\xf1T(P\xd6m\x80\x07\xd6 \xe4\x05\x0bW\x15\xdc\x83\xf4\xa9!\xd3l\xe9\xceG\xd0\xd1<]\x85\xf2\xb0\xff\x83\x18\xd2\x87~\xec/c\xb91\xbdGAz\x81\xa582z\xf9'\xda>"
  },
  {
    b"a b c d",
    b"q?Y+\xd57\xf7r]I\x1a\x03\xe87\xd6J",
    b"0\xa4}\x96n\x96\xef\x82\x053\xb1`\xcd%\xbca\xceq\xec|",
    b"\xf8,\xe1\xb6S\xe3\x0b\x1c\xebW\x11\xbb\xf7Ye\xdd$Q0\x11\xd7\xda\xa4\x8b\xbd\x86\x10U\x01T\xa1\xfd",
    b"\xa9a\xae&\xa9\xf6\xd3&\xee\x11\xf8\xe8D\xba\xb7\x90\xc1\x1f\xc8\xdci\x8d\xd6\\\x8f\xa2\x82\xa3\xee\x8a\xaf\xc3q\x85\xc6\xa1\xabW\x9a\xb2dz\xb9D\xfc\xa7\xfb\xbc\xdd\x8dTo\x81 \xf0\x13)\xd6\xd0\x1cR\xc3[\x81"
  },
  {
    b"",
    b"\xd4\x1d\x8c\xd9\x8f\x00\xb2\x04\xe9\x80\x09\x98\xec\xf8B~",
    b"\xda9\xa3\xee^kK\x0d2U\xbf\xef\x95`\x18\x90\xaf\xd8\x07\x09",
    b"\xe3\xb0\xc4B\x98\xfc\x1c\x14\x9a\xfb\xf4\xc8\x99o\xb9$'\xaeA\xe4d\x9b\x93L\xa4\x95\x99\x1bxR\xb8U",
    b"\xcf\x83\xe15~\xef\xb8\xbd\xf1T(P\xd6m\x80\x07\xd6 \xe4\x05\x0bW\x15\xdc\x83\xf4\xa9!\xd3l\xe9\xceG\xd0\xd1<]\x85\xf2\xb0\xff\x83\x18\xd2\x87~\xec/c\xb91\xbdGAz\x81\xa582z\xf9'\xda>"
  },
  {
    b"a b c d",
    b"q?Y+\xd57\xf7r]I\x1a\x03\xe87\xd6J",
    b"0\xa4}\x96n\x96\xef\x82\x053\xb1`\xcd%\xbca\xceq\xec|",
    b"\xf8,\xe1\xb6S\xe3\x0b\x1c\xebW\x11\xbb\xf7Ye\xdd$Q0\x11\xd7\xda\xa4\x8b\xbd\x86\x10U\x01T\xa1\xfd",
    b"\xa9a\xae&\xa9\xf6\xd3&\xee\x11\xf8\xe8D\xba\xb7\x90\xc1\x1f\xc8\xdci\x8d\xd6\\\x8f\xa2\x82\xa3\xee\x8a\xaf\xc3q\x85\xc6\xa1\xabW\x9a\xb2dz\xb9D\xfc\xa7\xfb\xbc\xdd\x8dTo\x81 \xf0\x13)\xd6\xd0\x1cR\xc3[\x81"
  },
  {
    b"\x00\x01\x02\x03\x04\x05",
    b"\xd1Z\xe591\x88\x0f\xd7\xb7$\xddx\x88\xb4\xb4\xed",
    b"\x86\x84`\xd9\x8d\x09\xd8\xbb\xb9={l\xdd\x15\xcc\x7f\xbe\xc6v\xb9",
    b"\x17\xe8\x8d\xb1\x87\xaf\xd6,\x16\xe5\xde\xbf>e'\xcd\x00k\xc0\x12\xbc\x90\xb5\x1a\x81\x0c\xd8\x0c-Q\x1fC",
    b"/81\xbc\xcc\x94\xcf\x06\x1b\xcf\xa5\xf8\xc2<\x14)\xd2n;\xc6\xb7n\xda\xd9=\x90%\xcb\x91\xc9\x03\xafl\xf9\xc95\xdc7\x19<\x04\xc2\xc6n}\x9d\xe1|5\x82\x84A\x82\x18\xaf\xea!`\x14z\xaa\x91/L"
  },
  {
    b"\xd0\x9c\xd0\xbe\xd1\x88\xd0\xb0_\xc3\xb6\xc3\xa15\xe3\x83\x9b\xe3\x83\x90\xe3\x83\xbc\xe3\x82\xaf\xe3\x83\xa9\xe3\x83\x95\xe3\x83\x88\xe9\xb0\xbb\xe9\xb0\xbb",
    b"O\x84\xa3\x8du\x07\x8c\x15\x81\x8c\xac\xa6\xb8k&\xbe",
    b"n\xd4\x8c'_\xe4\xd8\xd7\xbd\x9d\xaa7\xfa\xb7+\xd2l\x09\xc9\xc4",
    b"0\xcbl.\x95\xbd\x9d\xaf\xa5\xad\xb1\xf5S\xed\xb7\x83\x11$\xd9q-&1\xcd\xb9\xf7\xf3\x87\xc6\xcc'A",
    b'\xe5;\x83\xe0\xaecy\xa9\x87\xee6\\;p\xff"G<\xf1\x91\x9d!1(\xeb\xf3k\x99}{\x8f\x13c\xca\xe8\xed\xd9\x12\xcd\x14\xadI\x9c\x10_\x97L\xb1\xf8\xc8\xa5\xdb\x9d\xdb\xd7jO\x11%\xdeH\x04@\xa8'
  },
  {
    b"\xaf\xbf\xcf\xdf\xef\xff",
    b"Q\xf2\\\xcb\x92\xf5\x84\x08y/\xa2$h\x12\x10\x13",
    b"iQ\xc7\xd0,\xda\xe7e\x91g\xe03\x8f\xd7\xd8\x9f\x81\xb7\x8b\xa0",
    b'\xcfW7\x14\xea$\x85W8J\xfc\xfcd\xff\xb0\x8ci\xe5~\xea\x1c\x96\x0f\xbb\xa9\x97"\xc3\xdc\xf9\xa2v',
    b"\\(\\\x94Fu^\xe53\x97\xfc\xb1k\xbf\x1f\xbd\x8c,II0\x04-\xafv'!\x1d\xefC\x00[\xa6V\x87U\xd3V\xee\x13\xe8\xe1\xa7\xe0\xc2\xa1\xd5\xce\x9d\xe5\xfa\x83\x82\xfa3 \xce9/\xf0_\xf7\xc1\xf2"
  }
]
==

# Converting hashes to hex is one of the most common use cases for TO_HEX.
[name=hash_functions_with_hex]
SELECT
  input_string,
  TO_HEX(MD5(input_bytes)),
  TO_HEX(MD5(input_string)),
  TO_HEX(SHA1(input_bytes)),
  TO_HEX(SHA1(input_string)),
  TO_HEX(SHA256(input_bytes)),
  TO_HEX(SHA256(input_string)),
  TO_HEX(SHA512(input_bytes)),
  TO_HEX(SHA512(input_string))
FROM (
  SELECT
    CAST(input_string AS BYTES) AS input_bytes,
    input_string,
    off
  FROM UNNEST(['', 'a b c d', 'abcABCжщфЖЩФ', 'a b c d',
               'Моша_öá5ホバークラフト鰻鰻']) AS input_string WITH OFFSET off
)
ORDER BY off
--
ARRAY<STRUCT<input_string STRING,
             STRING,
             STRING,
             STRING,
             STRING,
             STRING,
             STRING,
             STRING,
             STRING>>
[
  {
    "",
    "d41d8cd98f00b204e9800998ecf8427e",
    "d41d8cd98f00b204e9800998ecf8427e",
    "da39a3ee5e6b4b0d3255bfef95601890afd80709",
    "da39a3ee5e6b4b0d3255bfef95601890afd80709",
    "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
    "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
    "cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e",
    "cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e"
  },
  {
    "a b c d",
    "713f592bd537f7725d491a03e837d64a",
    "713f592bd537f7725d491a03e837d64a",
    "30a47d966e96ef820533b160cd25bc61ce71ec7c",
    "30a47d966e96ef820533b160cd25bc61ce71ec7c",
    "f82ce1b653e30b1ceb5711bbf75965dd24513011d7daa48bbd8610550154a1fd",
    "f82ce1b653e30b1ceb5711bbf75965dd24513011d7daa48bbd8610550154a1fd",
    "a961ae26a9f6d326ee11f8e844bab790c11fc8dc698dd65c8fa282a3ee8aafc37185c6a1ab579ab2647ab944fca7fbbcdd8d546f8120f01329d6d01c52c35b81",
    "a961ae26a9f6d326ee11f8e844bab790c11fc8dc698dd65c8fa282a3ee8aafc37185c6a1ab579ab2647ab944fca7fbbcdd8d546f8120f01329d6d01c52c35b81"
  },
  {
    "abcABCжщфЖЩФ",
    "cbd14d089f78b5c01f5e488d934c1edc",
    "cbd14d089f78b5c01f5e488d934c1edc",
    "303c3c5ef48224e156c9e0899b01d8225ff70f20",
    "303c3c5ef48224e156c9e0899b01d8225ff70f20",
    "b0c486d0434e078fa1ff8fc23bf984bc41dd31d2e95ca69a427ddbbb56b29fc2",
    "b0c486d0434e078fa1ff8fc23bf984bc41dd31d2e95ca69a427ddbbb56b29fc2",
    "668ca297ac57fa5405af77eac9cfca61df282a7fa9c61948408cd3218150411d98129ff79e4439e4365b805273fb87f764167a50193e550d599e9741c5442ecd",
    "668ca297ac57fa5405af77eac9cfca61df282a7fa9c61948408cd3218150411d98129ff79e4439e4365b805273fb87f764167a50193e550d599e9741c5442ecd"
  },
  {
    "a b c d",
    "713f592bd537f7725d491a03e837d64a",
    "713f592bd537f7725d491a03e837d64a",
    "30a47d966e96ef820533b160cd25bc61ce71ec7c",
    "30a47d966e96ef820533b160cd25bc61ce71ec7c",
    "f82ce1b653e30b1ceb5711bbf75965dd24513011d7daa48bbd8610550154a1fd",
    "f82ce1b653e30b1ceb5711bbf75965dd24513011d7daa48bbd8610550154a1fd",
    "a961ae26a9f6d326ee11f8e844bab790c11fc8dc698dd65c8fa282a3ee8aafc37185c6a1ab579ab2647ab944fca7fbbcdd8d546f8120f01329d6d01c52c35b81",
    "a961ae26a9f6d326ee11f8e844bab790c11fc8dc698dd65c8fa282a3ee8aafc37185c6a1ab579ab2647ab944fca7fbbcdd8d546f8120f01329d6d01c52c35b81"
  },
  {
    "Моша_öá5ホバークラフト鰻鰻",
    "4f84a38d75078c15818caca6b86b26be",
    "4f84a38d75078c15818caca6b86b26be",
    "6ed48c275fe4d8d7bd9daa37fab72bd26c09c9c4",
    "6ed48c275fe4d8d7bd9daa37fab72bd26c09c9c4",
    "30cb6c2e95bd9dafa5adb1f553edb7831124d9712d2631cdb9f7f387c6cc2741",
    "30cb6c2e95bd9dafa5adb1f553edb7831124d9712d2631cdb9f7f387c6cc2741",
    "e53b83e0ae6379a987ee365c3b70ff22473cf1919d213128ebf36b997d7b8f1363cae8edd912cd14ad499c105f974cb1f8c8a5db9ddbd76a4f1125de480440a8",
    "e53b83e0ae6379a987ee365c3b70ff22473cf1919d213128ebf36b997d7b8f1363cae8edd912cd14ad499c105f974cb1f8c8a5db9ddbd76a4f1125de480440a8"
  }
]
